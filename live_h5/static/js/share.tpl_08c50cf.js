!function(e,i,t){var n=e[i]=e[i]||{};e[i]=n={input:function(){function e(e){var i;for(i in e)return!1;return!0}t(document).on(clickOrTouch,".w-input .input",function(i){if(i.preventDefault(),e(user)){var n=location.host,o=n.substr(0,n.indexOf(".")+1);-1==t.inArray(o,["test.","dev."])?o="":"",o="test.",window.location.href="http://"+o+"m.yizhibo.com/www/live/login?redirect_url="+window.location.href}else t("#video-box .modal").removeClass("hide"),t("#video-box .modal input").focus()}).on(clickOrTouch,".send-msg",function(){chat.submit()})}(),share:function(){t(document).on(clickOrTouch,".w-share",function(){t(".sns-share").show(),weixin||t(".weixin, .friend-circle",t(".sns-ctn").addClass("sns2")).remove()}).on(clickOrTouch,".weixin, .friend-circle",function(){t("body").animate({scrollTop:0}),t("#rt-share").show()}).on(clickOrTouch,".weibo, .qq",function(){var n=[],o=t(this).data("sns"),a=i[o];for(var r in a)n.push(r+"="+encodeURIComponent(a[r]||""));e.location="weibo"==o?"http://service.weibo.com/share/share.php?"+n.join("&"):"http://connect.qq.com/widget/shareqq/index.html?"+n.join("&")}),t("#rt-share").on(clickOrTouch,function(){t("#rt-share").hide()}),t(".sns-share h4").on(clickOrTouch,function(){t(".sns-share").hide()});var i={"default":{title:document.title||"直播就要#一直播#，我正在一直播分享快乐，快来支持我！点击直接观看>>",desc:"直播就要一直播！",pic:shareConfig.wx.imgUrl,link:shareConfig.wx.link},weixin:{title:shareConfig.wx.title,desc:shareConfig.wx.desc,pic:shareConfig.wx.imgUrl,link:shareConfig.wx.link},weibo:{appkey:shareConfig.rmzb.appid,title:document.title||"直播就要#一直播#，我正在一直播分享快乐，快来支持我！点击直接观看>>",site:"一直播",content:"utf-8",pic:shareConfig.wx.imgUrl,url:e.location.href},qq:{title:document.title||"直播就要#一直播#，我正在一直播分享快乐，快来支持我！点击直接观看>>",desc:"直播就要一直播！",site:"一直播",summary:"直播就要#一直播#，我正在一直播分享快乐，快来支持我！点击直接观看>>",pic:shareConfig.wx.imgUrl,url:e.location.href},qqzone:{title:document.title||"直播就要#一直播#，我正在一直播分享快乐，快来支持我！点击直接观看>>",desc:"直播就要一直播！",site:"一直播",pic:shareConfig.wx.imgUrl,url:e.location.href},funcs:{weibo:null,weixin:null,qq:null,qqzone:null}};e.wx.ready(function(){e.wx.onMenuShareTimeline({title:i.weixin.title,desc:i.weixin.desc,imgUrl:i.weixin.pic,link:i.weixin.link}),e.wx.onMenuShareAppMessage({title:i.weixin.title,desc:i.weixin.desc,link:i.weixin.link,imgUrl:i.weixin.pic}),e.wx.onMenuShareQQ({title:i.qq.title,desc:i.qq.desc,link:i.qq.url,imgUrl:i.qq.pic}),e.wx.onMenuShareWeibo({title:i.weibo.title,desc:i.weibo.desc,link:i.weibo.url,imgUrl:i.weibo.pic}),e.wx.onMenuShareQZone({title:i.qqzone.title,desc:i.qqzone.desc,link:i.qqzone.url,imgUrl:i.qqzone.pic})})}(),gift:function(){function i(i,o){t.ajax({url:shareConfig.url.buy_gift_h5,type:"post",data:{scid:shareConfig.sObj.scid||shareConfig.sObj.carouselid,giftid:t(".active").data("giftid"),amount:i,carouselid:shareConfig.sObj.carouselid||""}}).done(function(a){if(1==a.result){var r=t(".active.elem").data("giftid"),l={};t.extend(l,initData.gifttemp["gift"+r],{nickname:user.nickname,avatar:user.avatar,memberid:user.memberid,level:user.level,ytypevt:user.ytypevt,amount:i}),chat.view.gift(JSON.stringify(l))}1==o?1==a.result?(t(".recharge").html("<span>充值&nbsp;&nbsp;</span>"+a.data.goldcoin+"金币&nbsp;&nbsp;&gt;"),n()):600==a.result?(t(".login").show(),t(".login .ok").on(clickOrTouch,function(){e.location.href=a.redirect_url})):100==a.result?jConfirm(a.msg,"",function(i){if(i)if(weixin)t(".guide-pay").show();else{var n=location.host,o=n.substr(0,n.indexOf(".")+1);-1==t.inArray(o,["test.","dev."])?o="":"";var a=void 0==user.memberid?"":user.memberid;e.location.href="//"+o+"static.yizhibo.com/html/h5pay/pay-checkstand.html?memberid="+a}}):jAlert(a.msg,""):0==o&&1==a.result&&t(".recharge").html("<span>充值&nbsp;&nbsp;</span>"+a.data.goldcoin+"金币&nbsp;&nbsp;&gt;")}).fail(function(){console.log("gift error.")})}function n(){t(".active div").is(".lian")&&(t(".send").hide(),t(".big-bg").show(),t(".send66").animate({left:"0.24rem",top:"2.186667rem"},100),t(".send520").animate({left:"0.35rem",top:"1.12rem"},100),t(".send888").animate({left:"1.1rem",top:"0.4rem"},100),t(".send1314").animate({left:"2.25rem",top:"0.33rem"},100),a(30),r())}function o(e,i,t,n,o,a){this.x=e,this.y=i,this.radius=t,this.start=n,this.angle=o,this.fillStyle=a}function a(e){c.clearRect(0,0,116,116),d.draw(e),h.draw(e),u.draw(e)}function r(){clearInterval(l),f=30,l=setInterval(function(){-1==f?(clearInterval(l),t(".send66,.send520,.send888,.send1314").css({left:"1.8rem",top:"1.8rem"}),t(".big-bg").hide(),t(".send").show(),f=30,h.angle=1.5*Math.PI,a(30)):(h.angle=30==f?1.5*Math.PI:0==f?-0.5*Math.PI:1.5*Math.PI-f/30*2*Math.PI,a(f--))},100)}var l=null;t(document).on(clickOrTouch,".w-gift",function(){t(".content-box, .btm-menu, .sns-share").hide(),t(".gift-slider").show()}).on(clickOrTouch,".elem",function(){clicknum=0,t(".active").removeClass("active"),t(this).addClass("active"),t(".send").removeClass("disabled")}).on(clickOrTouch,".send",function(){t(this).is(".disabled")||i(1,1)}).on(clickOrTouch,".lx-click",function(){r(),i(1,0)}).on(clickOrTouch,".send66,.send520,.send888,.send1314",function(){var e=parseInt(t(this).text());i(e,0)});var s=document.getElementById("canvas"),c=s.getContext("2d"),d=new o(58,58,58,0,2*Math.PI,"#FF670F"),u=new o(58,58,50,0,2*Math.PI,"#FF670F"),h=new o(58,58,58,1.5*Math.PI,1.5*Math.PI,"#FF976B"),f=30,l=null;o.prototype.draw=function(e){c.beginPath(),c.moveTo(58,58),c.arc(this.x,this.y,this.radius,this.start,this.angle),c.fillStyle=this.fillStyle,c.closePath(),c.fill(),c.font="italic 30px Georgia ",c.fillStyle="#ffffff",c.fillText("连击",26,50),c.font="italic 30px PingFang SC Medium",c.fillStyle="#ffffff",c.fillText(e,42,90)}},smallGift:function(){function i(e,i,t,n,o,a){this.x=e,this.y=i,this.radius=t,this.start=n,this.angle=o,this.fillStyle=a}function n(e){r.clearRect(0,0,116,116),l.draw(e),c.draw(e),s.draw(e)}function o(){clearInterval(u),d=20,u=setInterval(function(){-1==d?(clearInterval(u),d=20,c.angle=1.5*Math.PI,n(20)):(c.angle=20==d?1.5*Math.PI:0==d?-0.5*Math.PI:1.5*Math.PI-d/20*2*Math.PI,n(d--))},100)}t(document).on(clickOrTouch,".sgift",function(){var i=i||window.event;i.stopPropagation();var n=t.ajax({url:shareConfig.url.buy_gift_h5,type:"post",data:{scid:shareConfig.sObj.scid||shareConfig.sObj.carouselid,giftid:t(".sgift img").data("giftid"),amount:1,carouselid:shareConfig.sObj.carouselid||""}});n.done(function(i){if(600==i.result)t(".login").show(),t(".login .ok").on(clickOrTouch,function(){e.location.href=i.redirect_url});else if(100==i.result)jConfirm(i.msg,"",function(i){if(i)if(weixin)t(".guide-pay").show();else{var n=location.host,o=n.substr(0,n.indexOf(".")+1);-1==t.inArray(o,["test.","dev."])?o="":"";var a=void 0==user.memberid?"":user.memberid;e.location.href="//"+o+"static.yizhibo.com/html/h5pay/pay-checkstand.html?memberid="+a}});else if(1==i.result){o();var n=i.data,a=t(".sgift img").data("giftid");t.extend(n,{nickname:user.nickname,avatar:user.avatar,memberid:user.memberid,level:user.level,ytypevt:user.ytypevt,goldcoin:"",giftid:t(".sgift img").data("giftid"),name:initData.gifttemp["gift"+a].name,cover:initData.gifttemp["gift"+a].cover,isbursts:initData.gifttemp["gift"+a].isbursts,childtype:initData.gifttemp["gift"+a].childtype,amount:1}),chat.view.gift(JSON.stringify(n))}else jAlert(i.msg,"")}),n.fail(function(){console.log("面板礼物送礼失败...")})});var a=document.getElementById("sgift"),r=a.getContext("2d"),l=new i(58,58,58,0,2*Math.PI,"rgba(0,0,0,1)"),s=new i(58,58,50,0,2*Math.PI,"rgba(0,0,0,1)"),c=new i(58,58,58,1.5*Math.PI,1.5*Math.PI,"#FF976B"),d=20,u=null;i.prototype.draw=function(){r.beginPath(),r.moveTo(58,58),r.arc(this.x,this.y,this.radius,this.start,this.angle),r.fillStyle=this.fillStyle,r.closePath(),r.fill()}}(),lockScreen:function(){function e(){t(".player-lock, .leadReece").css("display","block"),t(document).on(clickOrTouch,".player-lock",function(){t(".player-lock, .leadReece").hide()}).on(clickOrTouch,".leadReece .close",function(){t(".player-lock, .leadReece").hide()})}var i=0;setInterval(function(){i+=1,60==i&&e()},1e3)}(),dealcw:function(){t.each(t(".topic"),function(e,i){var n=t(i).text(),o="";t(i).html("");var a=n.substring(n.indexOf("#"),n.lastIndexOf("#"));a.indexOf("#")>-1&&(a.length>11?(a=a.substr(0,10),o=a+"...#",t(i).html(o),a+="#"):(a+="#",t(i).html(a)));var r=n.substr(n.lastIndexOf("#")+1,n.length);""!=r?(r.length>10&&(r=r.substr(0,10),r+="..."),t(i).next().html(r)):t(i).next().html("我正在一直播分享快乐")})}(),playBack:function(){t(document).on(clickOrTouch,".playback",function(){weibo||qq||weixin?(t("body").animate({scrollTop:0}),t(".shadow").css({display:"block"})):e.location.href="xktv://jump?type=5&dataStr="+shareConfig.sObj.scid})}(),pause:function(){var i=!1;t("#video, .pause, .pause-wrap").on(clickOrTouch,function(n){var n=n||e.event;if(n.stopPropagation(),!i){var o=t("video")[0];o&&o.paused?(t(".videobg, .pause").hide(),o.play()):t(".modal").is(".hide")?o&&!t(".btm-menu").is(":hidden")&&(t(".videobg, .pause").show(),o.pause()):t(".modal").addClass("hide")}t(".btm-menu").is(":hidden")&&(t(".gift-slider").hide(),t(".content-box, .btm-menu").show(),t(".wrap-menu").removeClass("switch"),t(".w-share,.w-gift").show(),t(".w-input .input").blur(),t(".wrap-menu .cut, .wrap-menu .send-msg").css("display","none")),i=!1}),t("#video").on("touchmove",function(){i=!0})}(),recharge:function(){t(document).on(clickOrTouch,".recharge",function(){var i=location.host,n=i.substr(0,i.indexOf(".")+1);-1==t.inArray(n,["test.","dev."])?n="":"";var o=void 0==user.memberid?"":user.memberid;e.location.href="//"+n+"static.yizhibo.com/html/h5pay/pay-checkstand.html?memberid="+o}).on(clickOrTouch,".guide-pay figure .close",function(i){var i=e.event||i;i.preventDefault(),t(".guide-pay").hide()})}(),login:function(){t(document).on(clickOrTouch,".login .close, .login .cancel",function(i){var i=i||e.event;i.preventDefault(),t(".login").hide()})}(),magicWin:function(){new Mlink({mlink:"https://a.yzbo.tv/AAah",button:document.querySelectorAll("a#btnOpenApp"),tparams:{u_id:shareConfig.sObj.unq_member_key},autoRedirect:!1,autoRedirectToDownloadUrl:!0,downloadWhenUniversalLinkFailed:!1}),new Mlink({mlink:"https://a.yzbo.tv/AAAj?type=1&dataStr="+shareConfig.sObj.scid,button:document.querySelectorAll("a#enter_room"),tparams:{u_id:shareConfig.sObj.unq_member_key},autoRedirect:!1,autoRedirectToDownloadUrl:!0,downloadWhenUniversalLinkFailed:!1})},monitorPro:function(){t(e).scroll(function(){t(document).scrollTop()>t(e).height()/2?(t(".footer").show(),t(".sns-share").hide()):t(".footer").hide()})}(),newsApp:function(){var e=t.ajax({url:"/www/live/get_hot_list",type:"post",async:!1,data:{page:1,limit:"20"},dataType:"json"});e.done(function(e){1==e.result&&[1,2,3].forEach(function(i,n){var o=e.data.list[n].nickname;o.length>10?o=o.substr(.1)+"...":"",t(".scroll-image-wrapper li img").eq(i).attr("src",e.data.list[n].avatar),t(".scroll-title-wrapper li a").eq(i).html("我在一直播，快来跟我互动吧！<br>"+o)})}),e.fail(function(){console.log("热门列表数据轮播加载失败...")});var i=parseInt(t(".scroll-title-wrapper li.current").width())+1;t(".doc-footer-wrapper .scroll-title-wrapper li:gt(0)").css({left:i}),t(".scroll-title-wrapper li.current").css({left:0});setInterval(function(){var e=t(".scroll-image-wrapper li.active").index(),n=t(".scroll-title-wrapper li.current").index();t(".scroll-image-wrapper li.active, .scroll-panel li.active").removeClass("active"),t(".scroll-image-wrapper li").eq((e+1)%4).addClass("active"),t(".scroll-panel li").eq((e+1)%4).addClass("active"),t(".scroll-title-wrapper li.current").removeClass("current").css({left:-i}),t(".scroll-title-wrapper li").eq((n+1)%4).addClass("current").css({left:0}),t(".scroll-title-wrapper li").eq((n+2)%4).removeClass("hide").css({left:i}),t(".scroll-title-wrapper li").eq((n+3)%4).addClass("hide").css({left:i})},3e3)}(),panelGift:function(){var e=location.host,i=e.substr(0,e.indexOf(".")+1);-1==t.inArray(i,["test.","dev."])?i="":"";var n=t.ajax({url:"//"+i+"pay.yizhibo.com/gift/api/get_user_panel_gift_background",data:{anchorid:shareConfig.sObj.memberid},type:"get",async:!1,dataType:"jsonp",jsonp:"callback",jsonpCallback:"return_callback1"});n.done(function(e){1==e.result&&t(".sgift img").attr("src",e.data.cover).data("coin",e.data.price).data("giftid",e.data.giftId)}),n.fail(function(){console.log("面板礼物加载失败...")})}(),init:function(){1==shareConfig.sObj.status?t("#video-box").remove():t("video")[0].controls=!1,t("video").length&&2==shareConfig.sObj.vscreen&&(t(".user-info,.user_live_room,.gold-coin,.yizhibo-logo").css({"background-color":"#1F1F1F"}),t(".w-input").addClass("input-border")),3==shareConfig.sObj.showtype&&t(".pay-live").show(),ios&&(qq||weixin)&&0!=t("video").length?(t(".videobg, .pause").hide(),t("#video").get(0).play(),document.addEventListener("WeixinJSBridgeReady",function(){t("#video")[0].play()},!1)):t(".videobg, .pause").show(),this.gift(),this.magicWin()}},t(function(){n.init()})}(window,"liveroom",jQuery);